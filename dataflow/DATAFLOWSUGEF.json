{
	"name": "DATAFLOWSUGEF",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Source_SUGEF",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Destination_OperacionesActivasSugef",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "flatten1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ArchivoCIC as (Deudor as (AtrasoMaximodiasSBD as boolean, AtrasoMaximodiasSBD_12 as boolean, AtrasoMaximodiasSBD_24 as boolean, FechaInicioReqAutorizacion as date, IdPersona as integer, IndicadorAutorizacion as string, IndicadorNumericoDeudor as double, IndicadorNumericoDeudorSBD as double, {IndicadorReqAut1-05} as string, ListaGrupoInteresEconomico as string, ListaOperacionesActivas as (OperacionActiva as (ActualizadoAl as string, ComponenteFijoTasaVariable as double, Condicion as string, CuotaIntereses as double, CuotaPrincipal as double, DiasAtraso as boolean, Entidad as string, EsSBD as boolean, EstadoOperacion as boolean, FechaCambioTipoTasa as string, FechaFormalizacion as string, FechaVencimiento as string, FrecuenciaAjusteTasa as short, FrecuenciaPagoPrincipal as short, Generador as short, IdOperacion as string, Moneda as string, MontoAutorizado as double, MontoFormalizado as double, MontoNoDesembolsado as double, ParametroReferencia as short, PisoTasa as double, Saldo as double, TasaInteresNominal as double, TechoTasa as double, TipoOperacion as short, TipoTasa as string)[]), ListaOperacionesHistorico as (OperacionHistorica as (AtrasoMaximoEnDias as short, AtrasoMedioEnDias as double, Entidad as string, EsSBD as boolean, FechaVencimiento as string, IdOperacion as string, MotivoNoReporteliquidacion as short, NumMesesReportados as short, PonderadorOperacion as double, PuntajeOperacion as double, SituacionOperacion as short, UltimoPeriodoReportado as string)[]), MontoFiado as double, MontoFiadoSBD as double, MontoNoDesembolsadoSBD_ME as double, MontoNoDesembolsadoSBD_MN as double, MontoNoDesembolsado_ME as double, MontoNoDesembolsado_MN as double, NivelCompPagoHist as boolean, NivelCompPagoHistSBD as boolean, PorcentajeDolarizacion as double, PorcentajeTasavariable as double, SaldoAdeudadoSBD_ME as double, SaldoAdeudadoSBD_MN as double, SaldoTotalAdeudado_ME as double, SaldoTotalAdeudado_MN as double, TipoPersona as boolean, TotalCuotaCreditoSBD_ME as double, TotalCuotaCreditoSBD_MN as double, TotalCuotaCredito_ME as double, TotalCuotaCredito_MN as double)[], Encabezado as (IdEntidad as long, Periodo as date, Registros as integer))",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     validationMode: 'none',",
				"     namespaces: true) ~> source1",
				"source1 foldDown(unroll(ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva, ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva),",
				"     mapColumn(",
				"          ActualizadoAl = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.ActualizadoAl,",
				"          ComponenteFijoTasaVariable = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.ComponenteFijoTasaVariable,",
				"          Condicion = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.Condicion,",
				"          CuotaIntereses = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.CuotaIntereses,",
				"          CuotaPrincipal = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.CuotaPrincipal,",
				"          DiasAtraso = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.DiasAtraso,",
				"          Entidad = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.Entidad,",
				"          EsSBD = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.EsSBD,",
				"          EstadoOperacion = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.EstadoOperacion,",
				"          FechaCambioTipoTasa = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.FechaCambioTipoTasa,",
				"          FechaFormalizacion = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.FechaFormalizacion,",
				"          FechaVencimiento = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.FechaVencimiento,",
				"          FrecuenciaAjusteTasa = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.FrecuenciaAjusteTasa,",
				"          FrecuenciaPagoPrincipal = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.FrecuenciaPagoPrincipal,",
				"          Generador = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.Generador,",
				"          IdOperacion = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.IdOperacion,",
				"          Moneda = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.Moneda,",
				"          MontoAutorizado = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.MontoAutorizado,",
				"          MontoFormalizado = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.MontoFormalizado,",
				"          MontoNoDesembolsado = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.MontoNoDesembolsado,",
				"          ParametroReferencia = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.ParametroReferencia,",
				"          PisoTasa = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.PisoTasa,",
				"          Saldo = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.Saldo,",
				"          TasaInteresNominal = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.TasaInteresNominal,",
				"          TechoTasa = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.TechoTasa,",
				"          TipoOperacion = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.TipoOperacion,",
				"          TipoTasa = ArchivoCIC.Deudor.ListaOperacionesActivas.OperacionActiva.TipoTasa",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flatten1",
				"flatten1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          Entidad",
				"     )) ~> sink1"
			]
		}
	}
}